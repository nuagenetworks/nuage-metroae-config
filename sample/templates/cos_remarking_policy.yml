name: CosRemarkingPolicy
description: QoS template set - Create an CoS Remarking Policy
template-version: 1.0
software-type: Nuage Networks VSD
software-version: 5.1.1
variables:
  - name: enterprise_name
    type: reference
    optional: true
  - name: description
    type: string
    optional: true
  - name: cos_remarking_policy_name
    type: string
  - name: forwarding_classes
    type: list
    item-type: choice
    choices: ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H']
    optional: true
  - name: remarking_cos_list
    type: list
    item-type: string
    optional: true
actions:
  {% if enterprise_name is defined %}
  - select-object:
      type: Enterprise
      by-field: name
      value: {{ enterprise_name }}
      actions:
  {% endif %}
        - create-object:
            type: COSRemarkingPolicyTable
            actions:
              - set-values:
                  name: {{ cos_remarking_policy_name }}
                  description: {{ description | default("CoS remarking policy " + cos_remarking_policy_name | default("")) }}
              {% for class in forwarding_classes | default([]) %}
              - create-object:
                  type: COSRemarkingPolicy
                  actions:
                    - set-values:
                        DSCP: {{ remarking_cos_list[loop.index - 1] }}
                        forwardingClass: {{ class }}
              {% endfor %}
