- template: InfrastructureGatewayProfile
  values:
    - infrastructure_gateway_profile_name: nsg1
      proxy_dns_fqdn: mag.net
      upgrade_policy: download_and_upgrade_at_window
      upgrade_metadata_url: "http://localhost/upgrade"
      system_sync_time: "0 1 * * *"
      remote_logging_mode: rsyslog
      remote_log_server_address: 127.0.0.1
      remote_log_server_port: 9000
      ntp_server_key_id: 1
      ntp_server_key: abcdef

- template: InfrastructureVscProfile
  values:
    - infrastructure_vsc_profile_name: vsc1
      primary_controller_address: 10.0.0.1
      secondary_controller_address: 10.0.0.2
      probe_interval_msec: 60000

- template: Underlay
  values:
    - underlay_name: underlay1

- template: InfrastructureAccessProfile
  values:
    - infrastructure_access_profile_name: access1
      ssh_auth_mode: password_based
      user_name: user
      password: password

    - infrastructure_access_profile_name: access2
      ssh_auth_mode: password_and_key_based
      user_name: admin
      password: abcd1234
      source_ip_filters: ["1.1.1.1", "2.2.2.2", "3.3.3.3"]
      ssh_key_names:
        - key1
        - key2
      ssh_keys:
        - asdfasfdasdfasdfasf
        - japudofiuasdfoiudpfou

- template: RateLimiter
  values:
    - rate_limiter_name: rate1
      committed_information_rate: 1000
      peak_information_rate: 1000
      peak_burst_size: 1000

    - rate_limiter_name: rate2
      committed_information_rate: 200
      peak_information_rate: 200
      peak_burst_size: 200

- template: IngressQosPolicy
  values:
    - ingress_qos_policy_name: ingress-qos1
      parent_rate_limiter_name: rate1
      priority_queue_1_classes: ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H']
      priority_queue_1_rate_limiter_name: rate2

- template: EgressQosPolicy
  values:
    - egress_qos_policy_name: egress-qos1
      parent_rate_limiter_name: rate1
      priority_queue_1_classes: ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H']
      priority_queue_1_rate_limiter_name: rate2

- template: NSGateway
  values:
    - nsg_name: gateway1
      infrastructure_gateway_profile_name: nsg1
      infrastructure_access_profile_name: access1
      ssh_service: enabled
      instance_ssh_override: allowed
  children:
    - template: NetworkPort
      values:
        - network_port_name: network_port1
          physical_name: network_port1
          speed: BASET1000
          mtu: 1680
          vlan_range: 0-1024
          vlan_value: 0
          infrastructure_vsc_profile_name: vsc1
          ingress_qos_policy_name: ingress-qos1
          egress_qos_policy_name: egress-qos1
          uplink_role: primary
          underlay_name: underlay1
          download_rate_limit: 123.45
          nat_enabled: False
          route_to_underlay: False

    - template: AccessPort
      values:
        - access_port_name: access_port1
          physical_name: access_port1
          vlan_value_list: [2, 3, 4]
          ingress_qos_policy_names: ['', 'ingress-qos1', 'ingress-qos1']
          egress_qos_policy_names: ['', 'egress-qos1', 'egress-qos1']
